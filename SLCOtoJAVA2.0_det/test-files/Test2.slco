model Test2 {
    actions a

	classes
	P {
	  variables Integer y
	  state machines
		SM3 {
		  variables Integer x Boolean b
		  initial SMC0 states SMC1
		  transitions
			from SMC0 to SMC1 {
			  x >= 0 && x < 3; x := x + 1
			}
			from SMC0 to SMC1 {
			  x = 4; x := 0
			}
			from SMC0 to SMC1 {
			  y = 4
			}
			from SMC0 to SMC1 {
			  b or not b
			}
			from SMC1 to SMC0 {
              [y := y + 1]
			}
	    }
	    SM1 {
		  variables Integer[2] x
		  initial SMC0 states SMC1
		  transitions
			from SMC0 to SMC1 {
			  [x[0] = 0; x[0] := 0; y := y + 1]
			}
			from SMC0 to SMC1 {
			  x[0] = 1
			}
			from SMC0 to SMC1 {
			  [x[0] = 0; y := y + 1]
			}
			from SMC0 to SMC1 {
			  x[1] = 2
			}
			from SMC0 to SMC1 {
			  x[1] = 3
			}
			from SMC0 to SMC1 {
			  x[0] <= 3
			}
	    }
		SM2 {
		  variables Integer[2] x
		  initial SMC0 states SMC1
		  transitions
			from SMC0 to SMC1 {
			  x[0] % 4 = 0
			}
			from SMC0 to SMC1 {
			  x[0] % 4 = 1
			}
			from SMC0 to SMC1 {
			  x[0] % 4 = 2
			}
			from SMC0 to SMC1 {
			  x[0] % 4 = 3
			}
			from SMC0 to SMC1 {
			  x[0] <= 3
			}
	    }
	}
	objects p: P(y:=1), p2: P()
}
